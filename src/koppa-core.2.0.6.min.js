const dataTypes={string:"String",number:"Number",array:"Array",element:"Element",object:"Object",function:"Function",bool:"Bool"},functionTypes={arrow:"Arrow",async:"Async",normal:"Normal"},stringTypes={json:"Json",normal:"Normal"},prototypeExtensions=(()=>{const a={length:{get(){return Object.keys(this).length}},isObject:{get(){return"object"==typeof this&&null!==this}},isString:{get(){return"string"==typeof this||this instanceof String}},isBool:{get(){return!!(this.isString&&("true"===this.trim()||"1"===this.trim()||"false"===this.trim()||"0"===this.trim()))||!(!0!==this&&1!==this&&!1!==this&&0!==this)||"boolean"==typeof this||this instanceof Boolean}},isJson:{get(){try{JSON.parse(this)}catch(a){return!1}return!0}},isFunction:{get(){return!!(this&&this.constructor&&this.call&&this.apply)}},isArrow:{get(){return"function"==typeof this&&/^([^{=]+|\(.*\)\s*)?=>/.test(this.toString().replace(/\s/,""))}},isAsync:{get(){return"AsyncFunction"===this[Symbol.toStringTag]}},isNumber:{get(){return!!("number"==typeof this||this.isString&&this.match(/^[-+]?[0-9]*[,.]?[0-9]*$/g))}},isElement:{get(){return"object"==typeof HTMLElement?this instanceof HTMLElement:this&&"object"==typeof this&&null!==this&&1===this.nodeType&&"string"==typeof this.nodeName}},toNumber:{get(){const a=+this?+this:this.replace(/,/g,".").replace(/^\./g,"0.").replace(/\.$/g,".00");return"number"==typeof a?a:a.match(/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/)?parseFloat(a):parseInt(a,10)}},toBool:{get(){if(this.isBool){if(this.isString){if("true"===this.trim()||"1"===this.trim())return!0;if("false"===this.trim()||"0"===this.trim())return!1}return!0===this||1===this||!1!==this&&0!==this&&!!this}return!1}},getType:{get(){return this.isString?dataTypes.string:this.isBool?dataTypes.bool:this.isFunction?dataTypes.function:this.isNumber?dataTypes.number:this.isElement?dataTypes.element:Array.isArray(this)?dataTypes.array:dataTypes.object}},getFunctionType:{get(){return this.isArrow?functionTypes.arrow:this.isAsync?functionTypes.async:functionTypes.normal}},getStringType:{get(){return this.isJson?stringTypes.json:stringTypes.normal}},watch:{enumerable:!1,configurable:!0,writable:!1,value(a,b){let c,d;c=this[a],d=c;const e=()=>d,f=e=>(c=d,d=b.call(this,a,c,e),d);delete this[a]&&Object.defineProperty(this,a,{get:e,set:f,enumerable:!0,configurable:!0})}},byString:{get(){return(b,c)=>{let d=c.replace(/\[(\w+)\]/g,".$1").replace(/^\./,"");const e=d.split(".");let a=b;for(let d=0,f=e.length;d<f;d+=1){const b=e[d];if(b in a)a=a[b];else return}return a}}}},b={getNodeList:{get(){return(a,b)=>{let c;const d=[];a||(a="all"),a.isFunction&&(b=a,a="all");c="element"===a?NodeFilter.SHOW_ELEMENT:"text"===a?NodeFilter.SHOW_TEXT:"comment"===a?NodeFilter.SHOW_COMMENT:"all"===a?NodeFilter.SHOW_ALL:NodeFilter.SHOW_ALL;const e=a=>!b||b(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,f=document.createTreeWalker(this,c,e,!1);for(;f.nextNode();)d.push(f.currentNode);return d}}},toggleClass:{get(){return a=>(a.split(/, */g).forEach(a=>this.classList.toggle(a)),this)}},addClass:{get(){return a=>(this.classList.add(a),this)}},removeClass:{get(){return a=>(this.classList.remove(a),this)}},hasClass:{get(){return a=>!!this.classList.contains(a)}},replaceWith:{get(){return a=>{const b=this.parentNode;a?.isElement?b.replaceChild(a,this):a?.isString&&(this.before(a),this.remove())}}},siblings:{get(){return a=>{const b=[];for(let c=this.parentNode.firstChild;c;)1===c.nodeType&&c!==this&&(a&&a(c),b.push(c)),c=c.nextSibling;return b}}},before:{get(){return a=>{a.isElement?this.parentNode.insertBefore(a,this):a.isString&&this.insertAdjacentHTML("beforebegin",a)}}},after:{get(){return a=>{a.isElement?this.nextSibling?this.parentNode.insertBefore(a,this.nextSibling):this.parentNode.append(a):a.isString&&this.insertAdjacentHTML("afterend",a)}}},prepend:{get(){return a=>{a.isElement?1>this.children.length?this.append(a):this.firstElementChild.before(a):a.isString&&this.insertAdjacentHTML("afterbegin",a)}}},append:{get(){return a=>{a.isElement?this.appendChild(a):a.isString&&this.insertAdjacentHTML("beforeend",a)}}},html:{get(){return a=>{this.innerHTML=a?.isString?a:a.outerHTML}}},attr:{get(){return(a,b)=>(void 0!==b&&this.setAttribute(a,b||"true"),this.getAttribute(a))}},createHTML:{get(){return a=>{const b=document.createElement("div");if(b.innerHTML=a,1===b.children.length)return b.firstElementChild;const c=[];for(;b.firstElementChild;)c.push(b.firstElementChild);return c}}}};Object.defineProperties(Object.prototype,{length:a.length,isObject:a.isObject,isString:a.isString,isBool:a.isBool,isFunction:a.isFunction,isArrow:a.isArrow,isAsync:a.isAsync,isNumber:a.isNumber,isElement:a.isElement,toNumber:a.toNumber,toBool:a.toBool,getType:a.getType,watch:a.watch}),Object.defineProperties(Object,{byString:a.byString}),Object.defineProperties(String.prototype,{getStringType:a.getStringType,isJson:a.isJson}),Object.defineProperties(Function.prototype,{getFunctionType:a.getFunctionType}),Object.defineProperties(DocumentFragment.prototype,{getNodeList:b.getNodeList}),Object.defineProperties(HTMLElement.prototype,{getNodeList:b.getNodeList,toggleClass:b.toggleClass,addClass:b.addClass,removeClass:b.removeClass,hasClass:b.hasClass,replaceWith:b.replaceWith,siblings:b.siblings,before:b.before,after:b.after,prepend:b.prepend,append:b.append,html:b.html,attr:b.attr}),Object.defineProperties(Document.prototype,{createHTML:b.createHTML})})(),binder=function(_____,____){return eval(`((${Object.keys(_____).map(a=>`${a} = _____.${a}`).join(", ")}) => {
    let koppa, binder, item, _____, ____; return ${____};
  })();`)},watcher=(()=>{function a(a,b,c){if(b!==c){const a=setTimeout(()=>{clearTimeout(a),this.reConnect()},2);return c}return b}function b(a,b,c){if(b!==c){const a=a=>{const b=setTimeout(()=>{clearTimeout(b),f[a]?.forEach(a=>{a.reConnect()})},2)};for(let b=this;"$"!==b;)a(b),b=b.substr(0,b.lastIndexOf("."));return c}return b}function c(a){return Object.keys(e).filter(b=>a.startsWith(b))[0]}function d(a,b){f[a]||(f[a]=[]),f[a]?.includes(b)||f[a]?.push(b)}const e={},f={};return{add:function(f){f.watching.forEach(g=>{if(g.getType===dataTypes.string)if(g.startsWith("$")){const a=c(g),h=e[c(g)],i=g.replace(new RegExp(`^\\${a}.?`),""),j=i.split("."),k=j.pop(),l=j.join(".");d(`${a}${i?`.${i}`:""}`,f),i&&(l?Object.byString(h,l).watch(k,b.bind(g)):h.watch(k,b.bind(g)))}else{const b=g.split(".");if(1===b.length)f.data.watch(b[0],a.bind(f));else{const c=b.pop();Object.byString(f.data,b.join(".")).watch(c,a.bind(f))}}})},createTarget:(a,b)=>(e[`$.${a}`]=b,b)}})(),instance=(()=>{function a(a,b){const c=document.createElement("template");c.innerHTML=b;const d=c.content.getNodeList("element",a=>a.localName.includes("-"));return d.forEach((b,c)=>{d[c].dataset.instance=`${utils.getId()}|${a}`}),c}function b(a){const b={};return[...a.element.attributes].filter(a=>a.name.startsWith(":p")).forEach(c=>{const d=c.value.split("|");let e=`${d[0]}`;d[0].match(/^\$_/)&&(e=e.slice(2),b.$obj=e),a.parent?.data[e]||a.parent?.data[e]?.isNumber?b[e]=a.parent.data[e]:[b[e]]=[d[1]||!0],a.element.removeAttribute(c.name)}),b}function c(a){const b=a?.props,c=a?.parent?.childProps;Object.entries(b)?.forEach(([d])=>{c[a.id]===void 0&&(c[a.id]={}),c[a.id][d]=b[d]})}function d(a,b){return void 0!==a.parent?.data[b]&&void 0!==a.parent?.childProps?.[a.id]?.[b]?d(a.parent,b):a}function e(a,b,c){if(b!==c&&(this.parent.data[a]!==c&&this.parent?.childProps?.[this.id]?.[a]!==c&&(this.parent.childProps[this.id][a]=c,this.parent.data[a]=c),Object.keys(this.childProps).forEach(b=>{const d=b;this.childProps[d][a]!==c&&i[d].data[a]!==c&&(this.childProps[d][a]=c,i[d].data[a]=c)}),!j)){const b=setTimeout(()=>{clearTimeout(b),d(this,a).reConnect()},2),c=setTimeout(()=>{clearTimeout(c),j=!1},100);j=!0}return c}function f(b,c){if(!b)return null;const d=[];return b.forEach(a=>{a[2].isFunction&&d.push([a[0],a[1],a[2].bind(c)])}),d}function g(a){a.events.forEach(b=>{const c=b[0],d=b[1],e=b[2];let f=[],g=[];c.isString?f=c.split(","):c.isElement?f.push(c):Array.isArray(c)&&(f=c),f.forEach(b=>{b.isElement?g.push(b):g=g.concat([...a.fragment.querySelectorAll(b)])}),g.forEach(b=>{b.addEventListener(d,e.isArrow?e:e.bind(a.data))})})}function h(a){let{parent:b}=a;for(;!b.isUpdating&&!b.parent;)b=b.parent;return b.isUpdating}const i={};let j=!1;return new Proxy(i,{get:(a,b)=>a[b],set:async(d,j,k)=>{const l=k[0],m=k[1],n=utils.getIdent(l),o=i[n.self]||{id:n.self,name:j,parent:i[n.parent]||null,html:l.outerHTML,isStopped:!1,isUpdating:!1};if(o.element=l,o.refs={},o.slots={},o.reConnect=()=>{o.isUpdating||h(o)||(o.isUpdating=!0,o.element.replaceWith(o.html))},o.element.currentInstanceId=o.id,o.element.destroy=()=>{o.element.remove()},o.isStopped)return o.element.remove(),!1;o.template||(o.template=a(o.id,m[j].template)),o.fragment=o.template.content.cloneNode(!0),o.fragment.getNodeList("element",a=>a.hasAttribute("ref")).forEach(a=>{o.refs[a.getAttribute("ref")]=a,a.removeAttribute("ref")});const p=o.element.querySelectorAll("[slot]");p.length?p.forEach(a=>{o.slots[a.slot]=a.outerHTML}):o.slots._=o.element.innerHTML;const q=o.fragment.querySelectorAll("slot");q&&q.forEach(a=>{a.name||a.replaceWith(o.slots._),a.replaceWith(o.element.querySelector(`[slot="${a.name}"]`)?.outerHTML)});const r={refs:o.refs,slots:o.slots,stopRendering:()=>{o.isStopped=!0},reConnect:o.reConnect,...module};o.childProps={},o.props=b(o),c(o);let s;try{s=utils.binder({$:r},`{ ${m[j]?.script} }`)}catch(a){return window.console.error(`You have an Error in Script of "${j}" component`),!1}if(o.data=o.data?Object.assign(o.data,o.props):Object.assign(s.data,o.props),Object.keys(o.props).forEach(a=>{"$obj"!==a&&o.data.watch(a,e.bind(o))}),s.comp&&Object.entries(s.comp).forEach(a=>{const[b,c]=a;o.data[b]=c?.getType===dataTypes.function?c.call(o.data):c}),s.methods&&Object.entries(s.methods).forEach(a=>{const[b,c]=a;o.data[b]=c?.getType===dataTypes.function?c.bind(o.data):c}),s.watching&&(o.watching=s.watching,watcher.add(o)),o.pre=s.pre?.bind(o.data),o.created=s.created?.bind(o.data),o.merged=s.merged?.bind(o.data),o.destroy=s.destroy?.bind(o.data),o.updated=s.updated?.bind(o.data),o.events=f(s.events,o.data),Object.entries(utils.buildExtensions(s,o.data)).forEach(([a,b])=>{o[a]=b}),o.pre?.isAsync?await o.pre():o.pre?.(),o.isStopped)return o.element.remove(),!1;if(document.head.querySelector(`style[data-name="${j}"]`)||document.head.append(`<style data-name="${j}">${m[o.name].style}</style>`),o.element.innerHTML="",o.childs={},o.fragment.getNodeList("element",a=>a.localName.includes("-")).forEach(a=>{o.childs[utils.getIdent(a).self]=a}),await mediator.run("build",o),o.created?.isAsync?await o.created():o.created?.(),o.isStopped)return o.element.remove(),!1;for(o.events&&g(o);o.fragment.firstElementChild;)l.append(o.fragment.firstElementChild);return o.merged?.isAsync?await o.merged():o.merged?.(),!0===o.isUpdating&&(o.updated?.isAsync?await o.updated():o.updated?.(),o.isUpdating=!1),Reflect.set(d,n.self,o),k}})})(),mediator=(()=>{const mediators={connected:[],build:[function(instance){instance.fragment.getNodeList("element",a=>a.hasAttribute("loop")).forEach(loopNode=>{const attr=utils.replaceData(loopNode.getAttribute("loop"),instance.data).split(" in ");loopNode.removeAttribute("loop");const data=utils.binder(instance.data,`(() => ${attr[1]})()`);let ret="";data&&data.forEach((item,i)=>{ret+=loopNode.outerHTML.replace(/\{\{([^â¹‡]*?)\}\}/g,(m,c)=>eval(`(() => {const ${attr[0]} = ${JSON.stringify(item)}; const n = '${i}'; return ${c};})()`))}),loopNode.replaceWith(ret)})},function a(b,c,d){let e=[],f=[];c||(c=b.fragment.getNodeList("element")),d||(d=b.fragment.getNodeList("text"));const g=document.createElement("div");c.forEach(a=>{[...a.attributes].forEach(c=>{c.name.startsWith("@")&&utils.buildTrigger(c,a),c.value=utils.replaceData(c.value,b.data)})}),d.forEach(a=>{if(" "!==a.data)for(g.innerHTML=utils.replaceData(a.data,b.data);g.firstChild;){const b=g.firstChild;a.before(b),"#text"!==b.nodeName&&(f=f.concat(b.getNodeList("element")),e=e.concat(b.getNodeList("text")))}a.remove()}),g.remove(),(f.length||e.length)&&a(b,f,e)},function(a){a.fragment.getNodeList("element",a=>a.hasAttribute("if")).forEach(b=>{const c=b.getAttribute("if"),d=utils.binder(a.data,`(() => { try { return ${c}; } catch { return false; } })()`);d?b.removeAttribute("if"):b.remove()})}],after:[]},add=async(a,b)=>mediators[a].push(b),run=async(a,b)=>{await mediators[a]?.reduce((a,d)=>a.then(async()=>{d.isAsync?await d(b):d(b)}),Promise.resolve(null))};return{add,run}})(),transformer=(()=>{const a={source:[a=>{let b=-1;return a=a.replace(/<[^/]?\s*[\w]{1}[\w\d]*-[\w\d]+\s*[^>]*>/g,a=>a.replace(/:([\w]{1}[\w\d]*)(="([^"]*)")?/g,(a,c,d,e)=>(b+=1,"obj"===c?`:p${b}="${`$_${e.replace(/({{)|(}})/g,"")}`}|${e}"`:e?`:p${b}="${c}|${e}"`:`:p${b}="${c}"`))),a},a=>(a=new DOMParser().parseFromString(a,"text/html"),a={template:a.children[0].children[0].children[0].innerHTML.trim()||"",script:a.children[0].children[0].children[1].innerHTML.trim()||"data: {}",style:a.children[0].children[0].children[2].innerHTML.trim()||""},a)]};return{add:async(b,c)=>a[b].push(c),run:async(b,d)=>!!d&&(await a[b]?.reduce((a,b)=>a.then(async()=>{d=b.isAsync?await b(d):b(d)}),Promise.resolve(null)),d)}})(),module=(()=>{const a={};return new Proxy(a,{get:(a,b)=>a[b],set:async(b,c,d)=>{b[c]=d;let e=d.bind({getId:utils.getId,getIdent:utils.getIdent,createTrigger:utils.createTrigger,addExtension:utils.addExtension,dataTypes:utils.dataTypes,mediator,transformer,take:utils.take,module:a,instance,component,watcher});return e=e.isAsync?await e():e(),e?.isObject&&(b[c]=e),d}})})(),component=(()=>{return new Proxy({},{get:(a,b)=>a[b],set:async(a,b,c)=>(c=await transformer.run("source",c),customElements.define(b,class extends HTMLElement{async connectedCallback(){instance[b]=await(async()=>[this,component])();const a=b=>{const c=setTimeout(async()=>{clearTimeout(c),instance[this.instanceId]?b.isAsync?await b(instance[this.instanceId]):b(instance[this.instanceId]):a(b)},50)};a(async()=>{await mediator.run("connected",this)})}disconnectedCallback(){this.destroy?.()}}),a[b]=c,c)})})(),utils=(()=>{const usedIds=[],customEvents={},customEventsDetails={},triggers={},extensions={},getId=()=>{const a=Math.floor(Math.random()*99999999);return usedIds.includes(a)?getId():(usedIds.push(a),a)},getIdent=a=>{const b=a.dataset.instance?.split("|")||[getId(),null],c=b[0]?.toNumber;let d=b[1]?.toNumber;if(!d){const b=a.closest(`[data-instance]:not([data-instance="${a.dataset.instance||""}"])`);b&&(d=b.dataset.instance.split("|")[0]||null)}return a.dataset.instance=`${c}${d?`|${d}`:""}`,a.instanceId=c,{self:c,parent:d}},replaceData=(strg,data)=>strg.replace(/\{\{([^{{}}]*)\}\}/g,(m,c)=>{if(":"===c[0])return`{{${c.substr(1)}}}`;let ret=eval(`try { data.${c} } catch { 'undefined' }`);return ret?.isFunction?ret=ret.call(data):null===ret&&(ret="null"),ret}),buildTrigger=(a,b)=>{const c=a.name.substring(1);customEvents[c]||(customEventsDetails[c]=[],customEvents[c]=new CustomEvent(c,{detail:()=>customEventsDetails[c]}));const d=triggers[c];b.addEventListener(d?.type,()=>{customEventsDetails[c]=a.value.split(/,\s*/).filter(a=>""!==a),document.querySelector(d.target).dispatchEvent(customEvents[c])})},createTrigger=(a,b,c)=>{triggers[a]={type:b,target:c||"body"}},take=async(a,b)=>{if(a.isFunction)module[a.name]=a;else if(b.match(/^\.\/[a-z0-9_@\-^!#$%&+={}./\\[\]]+\.html/)){const c=await module.fetcher.get(b);component[a]=c.content}else component[a]=b},addExtension=(a,b)=>{extensions[a]=b},buildExtensions=(a,b)=>{const c={};return Object.entries(extensions).forEach(([d,e])=>{a[d]&&(c[d]=e===dataTypes.function?a[d].bind(b):a[d])}),c};return{getId,getIdent,replaceData,buildTrigger,binder,createTrigger,take,addExtension,buildExtensions,dataTypes}})(),fetcher=()=>{const a={},b=async(a,b)=>{const c=await fetch(a,b).then(a=>a).catch(b=>{let c=500,d="Internal Server Error";switch(b.toString()){case"Unauthorized":c=401,d="Unauthorized";break;case"Not Found":c=404,d="Not Found";break;default:c=500,d="Internal Server Error";}return{body:null,bodyUsed:!1,content:null,headers:{},ok:!1,redirected:!1,status:c,statusText:d,type:"basic",url:a}});return c},c=async(c,d)=>{let e=c.replace(/^\/|\.\//,`${window.location.origin}/`);e.includes(window.location.origin)||/^((http|https|ftp):\/\/)/.test(e)||(e=`${window.location.origin}/${e}`),d.credentials=e.match(new RegExp(window.location.origin,"ig"))?"include":"same-origin";let f=a[e];return a[e]||(f=await b(c,d)),f},d=async(b,e=0)=>{b.headers||(b.headers={}),b.mode="cors",b.cache="default",e+=1,"GET"!==b.method&&(b.headers["Content-Type"]=b.data.isObject?"application/json;charset=utf-8":"text/plain;charset=utf-8",b.body=JSON.stringify(b.data));const f=await c(b.url,b);if(f?.ok)f.content||(f.content=await f.text()),b&&b.isObject&&b.save&&!a[f.url]&&(a[f.url]=f);else if(e<1){const a=await d(b,e);return a}return f};return{get:async a=>{a.isString&&(a={url:a}),a.method="GET";const b=await d(a);return b},post:async a=>{a.method="POST";const b=await d(a);return b},put:async a=>{a.method="PUT";const b=await d(a);return b},delete:async a=>{a.method="DELETE";const b=await d(a);return b}}};function store(){const a={},b=a=>{const b=b=>!!(b&&a.getItem(b));return{set:(b,c)=>b&&c?a.setItem(b,JSON.stringify(c)):null,get:c=>c&&b(c)?JSON.parse(a.getItem(c)):null,exists:b,remove:b=>!!(b&&a.removeItem(b)),clear:()=>(a.clear(),!!a.length),length:()=>a.length}};return this.watcher.createTarget("store.state",a),{local:b(localStorage),session:b(sessionStorage),state:a}}function router(){const a=[];let b=null;const c=new Event("popstate",null),{protocol:d}=window.location,{hostname:e}=window.location,{port:f}=window.location,g=`${d}//${e}${f?`:${f}`:""}`,h={charset:"<meta charset=\"utf-8\"/>",title:"<title>{{content}}</title>",description:"<meta name=\"description\" content=\"{{content}}\"/>",keywords:"<meta name=\"keywords\" content=\"{{content}}\"/>",author:"<meta name=\"author\" content=\"{{content}}\"/>",copyright:"<meta name=\"copyright\" content=\"{{content}}\"/>",robots:"<meta name=\"robots\" content=\"{{content}}\"/>","cache-control":"<meta http-equiv=\"cache-control\" content=\"{{content}}\"/>",expires:"<meta http-equiv=\"expires\" content=\"{{content}}\"/>",refresh:"<meta http-equiv=\"refresh\" content=\"{{content}}\"/>"},i={refresh:document.head.querySelector("meta[http-equiv=\"refresh\"]"),expires:document.head.querySelector("meta[http-equiv=\"expires\"]"),"cache-control":document.head.querySelector("meta[http-equiv=\"cache-control\"]"),robots:document.head.querySelector("meta[name=\"robots\"]"),copyright:document.head.querySelector("meta[name=\"copyright\"]"),author:document.head.querySelector("meta[name=\"author\"]"),keywords:document.head.querySelector("meta[name=\"keywords\"]"),description:document.head.querySelector("meta[name=\"description\"]"),title:document.head.querySelector("title"),charset:document.head.querySelector("meta[charset]")};Object.keys(i).forEach(a=>{null!==i[a]&&document.head.prepend(i[a])});const j={charset:i.charset?.attr("charset"),title:i.title?.innerHTML||">&#8205;",description:i.description?.attr("content"),keywords:i.keywords?.attr("content"),author:i.author?.attr("content"),copyright:i.copyright?.attr("content"),robots:i.robots?.attr("content"),"cache-control":i["cache-control"]?.attr("content"),expires:i.expires?.attr("content"),refresh:i.refresh?.attr("content")};let k={...j},l={...j};const m=a=>{k=l,l={},Object.keys(i).forEach(b=>{l[b]=void 0!==a[b]&&!1===a[b]?a[b]||j[b]||!1:a[b]||k[b]||j[b]||!1}),Object.keys(i).forEach(a=>{!1===l[a]?i[a]?.remove():!1!==l[a]&&null===i[a]?i[a]=document.createHTML(h[a].replace(/{{content}}/,l[a])):"title"!==a&&"charset"!==a?i[a].attr("content",l[a]):"charset"===a?i[a].attr("charset",l[a]):"title"==a&&(i[a].innerHTML=l[a])}),l=Object.fromEntries(Object.entries(l).filter(([,a])=>!1!==a))},n=()=>l,o=a=>a.toString().replace(/\/+/g,"/").replace(/((\/$)|(^\/)|(^\.\.\/)|(^\.\/))/g,"").replace(/http:\/+/g,"http://").replace(/https:\/+/g,"https://"),p=a=>{let b="";return a.forEach(a=>{b+=`${""===b?"":"/"}${o(a)}`}),b},q=()=>{let b=!1;if(!a.length)return b;const c=o(window.location.pathname),d=c.split("/");return a.forEach(a=>{a.params={};const c=a.path.split("/");JSON.stringify(d)===JSON.stringify(c)&&c.forEach((e,f)=>{if(":"===e.charAt(0)){const b=e.slice(1,e.length-1).split("<"),c=new RegExp(b[1],"g");c.test(d[f])&&(a.params[b[0]]=d[f])}f===c.length-1&&(b=a)})}),b},r=async(a,c)=>{const d=q();let e=!0;d?((!window.history.state||!1!==window.history.state.middleware)&&(e=!c.data[c.data.$obj].middleware||(await c.data[c.data.$obj].middleware(d))),!0===e&&(e=!d.handler||(await d.handler(d.params))),!0===e&&(e=d.component),!1===e&&(e="error-404"),e.isString&&(void 0===this.component[e]?(e="error-404",a.html(`<${e}></${e}>`)):a.html(`<${e}></${e}>`))):(e="error-404",this.html(`<${e}></${e}>`)),b=d},s=(a,b)=>{window.addEventListener("popstate",async()=>{await r(a,b)},!0)},t=b=>{let c=!1;b.path=o(b.path),a.forEach(a=>{c=a.path===b.path}),c||(b.params={},a.push(b))},u=a=>a.forEach(a=>{a.handler&&(a.handler=a.handler.bind(a)),t(a)}),v=(a="",b={})=>{window.renderCounter=0,window.history.pushState(b,null,p([g,a])),dispatchEvent(c)},w=()=>b.params;return this.mediator.add("connected",async a=>{const b=this.instance[a.instanceId];"router-view"===a.localName&&(s(a,b),b.data.$obj&&(u(b.data[b.data.$obj].routes),await r(a,b))),b.head&&m(b.head)}),this.mediator.add("after",()=>{document.querySelectorAll("[push]").forEach(a=>{a.attr("href",a.attr("push")),a.removeAttribute("push"),a.addEventListener("click",a=>{a.preventDefault(),v(a.target.closest("[href]").attr("href"))})})}),this.addExtension("head",this.dataTypes.object),this.take("router-view","<template></template><script></script><style></style>"),{add:t,push:v,replace:(a="",b={})=>{window.renderCounter=0,window.history.replaceState(b,null,p([g,a])),dispatchEvent(c)},getParams:w,basePath:g,clearSlashes:o,urlBuilder:p,getHeader:n}}const koppa=(()=>{let a=!1;const b=new MutationObserver(b=>{b.forEach(()=>{if(!a){const b=setTimeout(async()=>{clearTimeout(b),await mediator.run("after")},50),c=setTimeout(()=>{clearTimeout(c),a=!1},100);a=!0}})});document.onreadystatechange=()=>{if("complete"===document.readyState){const a=setTimeout(async()=>{clearTimeout(a),await mediator.run("after"),b.observe(document.body,{subtree:!0,childList:!0})},200)}},utils.take(fetcher),utils.take(store),utils.take(router);const c=a=>document.body.prepend(`<${a}></${a}>`);return c.take=utils.take,c})();